<!doctype html><html lang=ru-ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="–ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤"><meta name=description content="https://azhidkov.pro/"><meta property="og:site_name" content="–ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤"><meta property="og:title" content="–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ JPoint - –ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://azhidkov.pro/microposts/22/11/ea-at-jpoint/"><meta property="og:image" content="https://azhidkov.pro/"><meta name=twitter:card content="summary"><meta name=twitter:site content="https://azhidkov.pro/microposts/22/11/ea-at-jpoint/"><meta name=twitter:image content="https://azhidkov.pro/"><base href=https://azhidkov.pro/microposts/22/11/ea-at-jpoint/><title>–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ JPoint - –ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤</title><link rel=canonical href=https://azhidkov.pro/microposts/22/11/ea-at-jpoint/><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700"><link rel=stylesheet href=/css/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css><link rel=stylesheet href=https://azhidkov.pro/css/custom.css><link rel=stylesheet href=https://azhidkov.pro/css/github.css><link rel=stylesheet href=https://azhidkov.pro/css/JetBrains-Mono.css><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=alternate href=https://azhidkov.pro/index.xml type=application/rss+xml title="–ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤"><link href=https://azhidkov.pro/index.xml rel=feed type=application/rss+xml title="–ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤"><meta name=generator content="Hugo 0.80.0"></head><body><main class=wrapper><link rel=apple-touch-icon sizes=180x180 href=apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://azhidkov.pro/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://azhidkov.pro/favicon-16x16.png><link rel=manifest href=site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet type=text/css><nav class=navigation><section class=container style=height:100%><img src=https://azhidkov.pro/images/logo.svg class=logo>
<a class=navigation-title href=/>–ê–ª–µ–∫—Å–µ–π –ñ–∏–¥–∫–æ–≤</a>
<input type=checkbox id=menu-control>
<label class="menu-mobile float-right" for=menu-control><span class="btn-mobile float-right">&#9776;</span><ul class=navigation-list><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/effects-diagram/landing>–î–∏–∞–≥—Ä–∞–º–º–∞ –≠—Ñ—Ñ–µ–∫—Ç–æ–≤</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/posts>–ë–ª–æ–≥</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/portfolio>–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</a></li><li class="navigation-item align-left"><a class=navigation-link href=https://azhidkov.pro/>–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li><li class=mobile-menu-lang-separator-full><hr></li><li class=multilingual-separator><p>|</p></li><li class="navigation-item align-left"><a href=https://azhidkov.pro/en/>En</a></li></ul></label></section></nav><div class=content><section class="container page"><article><header><h1>–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–∞ JPoint</h1></header><p>–ü—Ä–∏–≤–µ—Ç!</p><p><s>–£ –º–µ–Ω—è —Ä–µ–±—ë–Ω–æ–∫ –Ω–∞—á–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ö–æ–¥–∏—Ç—å –≤ –¥–µ—Ç—Å–∫–∏–π —Å–∞–¥!</s>
–ü–æ–∫–∞ –ø–∏—Å–∞–ª –ø–æ—Å—Ç - —Å–Ω–æ–≤–∞ –∑–∞–±–æ–ª–µ–ªü§¶‚Äç‚ôÇÔ∏è.</p><p>–ö–∞–∫ —ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –≤–∞—Å?
–í–æ-–ø–µ—Ä–≤—ã—Ö, –µ—Å–ª–∏ —É –≤–∞—Å —Å–µ–π—á–∞—Å –ø–µ—Ä–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –¥–æ —Ç—Ä—ë—Ö –ª–µ—Ç - –≤–µ—Ä—å—Ç–µ, —Å–≤–µ—Ç –≤ –∫–æ–Ω—Ü–µ —Ç—É–Ω–Ω–µ–ª—è –µ—Å—Ç—å, –≤–º–µ—Å—Ç–µ —Å —Å–∞–¥–æ–º —É –≤–∞—Å –Ω–∞—á–Ω—ë—Ç—Å—è –Ω–æ–≤–∞—è –∂–∏–∑–Ω—å:)</p><p>–ù–∞–ø—Ä–∏–º–µ—Ä, —É –≤–∞—Å —Å–Ω–æ–≤–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤—Ä–µ–º—è —Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–æ—Å–∏–∫–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ:)
–ò —è –≤–æ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ–ª –¥–æ–∫–ª–∞–¥ c JPoint "<s>–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥</s> <a href="https://www.youtube.com/watch?v=YBsihlkI1E8&list=PLVe-2wcL84b88Ec7BFQZ5aEcu_h6U9isn&index=3">TDD&DDD ‚Äî –≥–∞–π–¥ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏</a>".
<a href=https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev>–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–∫–ª–∞–¥–∞</a>.</p><p>–≠—Ç–æ –æ—á–µ—Ä–µ–¥–Ω–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª, –ø—Ä–æ –∫–æ—Ç–æ—Ä—ã–π —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å "–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –µ–≥–æ, –≤–æ–∑—å–º–∏—Ç–µ –î–∏–∞–≥—Ä–∞–º–º—É –≠—Ñ—Ñ–µ–∫—Ç–æ–≤ –¥–ª—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–æ–ª—É—á–∏—Ç–µ –≠–ü".
–ü–æ—ç—Ç–æ–º—É –≤ —Ü–µ–ª–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É, –Ω–æ —Ö–æ—á—É –ø—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ—á—å –æ—Ç —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é —è –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –∏ –æ—Ç–∫–∏–Ω—É–ª.
–ê –∏–º–µ–Ω–Ω–æ - <a href=https://fsharpforfunandprofit.com/rop/>Railway-oriented Programming</a> –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö.</p><p>–ü—Ä–∏ —Ç–æ–º, —á—Ç–æ —Å–∞–º–∞ –∏–¥–µ—è –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏ —è –ø—Ä–æ–¥–æ–ª–∂–∞—é –µ–π –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –≤ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º —Å—Ç–∏–ª–µ (guard-clause —Å –≤—ã–±—Ä–æ—Å–æ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è, "–ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–π–∏–π ROP"), –≤ —Å—Ç–∏–ª–µ –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö –æ–Ω–∞ –Ω–µ –ø–æ–¥–æ—à–ª–∞ –ø–æ—Ç–æ–º—É —á—Ç–æ:</p><div class="olist arabic"><ol class=arabic><li>–í –º–æ—ë–º –∫–æ–¥–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ 95% –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∏—Ö –º–∞–ø–ø–∏–Ω–≥–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å HTTP-–æ—Ç–≤–µ—Ç–∞.
–ò –°–∫–æ—Ç—Ç –í–ª–∞—à–∏–Ω, —Å–∞–º –ø–∏—à–µ—Ç, —á—Ç–æ <a href=https://fsharpforfunandprofit.com/posts/against-railway-oriented-programming/#2----dont-use-result-to-reinvent-exceptions>–Ω–µ –Ω–∞–¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ROP —Ç–∞–º, –≥–¥–µ –Ω—É–∂–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏—è</a>.</li><li>–í –ö–æ—Ç–ª–∏–Ω–µ –æ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —à—É–º–∞.
–ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –ö–æ—Ç–ª–∏–Ω–µ –±—É–∫–≤–∞–ª—å–Ω–æ –ª—é–±–æ–π –≤—ã–∑–æ–≤ –º–æ–∂–µ—Ç –≤—ã–±—Ä–æ—Å–∏—Ç—å –±—É–∫–≤–∞–ª—å–Ω–æ –ª—é–±–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∂–¥—É—é –≤–µ—Ä—Ö–Ω–µ-—É—Ä–æ–≤–Ω–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–¥–æ –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –≤ Result.runCatching, –Ω–∞–ø—Ä–∏–º–µ—Ä.
–ò –≤–æ–æ–±—â–µ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –æ–±—ä—ë–º–∞—Ö –∫–æ–¥–∞ –≤–∏–¥–Ω–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –Ω–∏–∂–µ.</li></ol></div><p>–í–æ—Ç –ø–µ—Ä–µ—á–µ–Ω—å –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤ (+ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏) —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∏–∑ <a href=https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdateService.kt#L12>—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</a>:</p><div class="olist arabic"><ol class=arabic><li><p>–ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏ –æ—Å–æ–∑–Ω–∞—Ç—å.</p><p><em>–ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥ –ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∏–π ROP –ø—Ä–æ—â–µ —á–∏—Ç–∞—Ç—å –∏ –æ—Å–æ–∑–Ω–∞–≤–∞—Ç—å.</em></p></li><li><p>—è–≤–ª—è–µ—Ç—Å—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π</p><p><em>–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü</em></p></li><li><p>–∏—Å–ø–æ–ª—å–∑—É–µ—Ç ROP - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∫–∞–∫ –≤–æ–∑–º–æ–∂–Ω—ã–π –Ω–µ—è–≤–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏</p><p><em>–í –ö–æ—Ç–ª–∏–Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è <strong>–≤—Å–µ–≥–¥–∞</strong> –æ–¥–∏–Ω –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–µ—è–≤–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.
–ò –µ—Å–ª–∏ –≤—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–µ—Ä–≤–∞–Ω–∏–∏ –ø–æ—Ç–æ–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è, —Ç–æ –ª—É—á—à–µ —ç—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –∞ –¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–º—É –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º—É —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É</em></p></li><li><p>–±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∞ –æ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—â–µ–≥–æ —Å–ª–æ—è</p><p><em>–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü</em></p></li><li><p>–ø—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ —Å–∞–º —Å–µ—Ä–≤–∏—Å –≤—ã—Å—Ç—É–ø–∞–µ—Ç —Ç—É–ø–æ–π —Ç—Ä—É–±–æ–π, –∫–æ—Ç–æ—Ä—ã–π –º–∞–∫—Å–∏–º—É–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω canExecute/execute</p><p><em>–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü</em></p></li><li><p>—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–µ –æ–±—è–∑–∞—Ç–∞–ª—å–Ω–æ - –º–æ–∂–Ω–æ –ø–æ–∫—Ä—ã—Ç—å –º–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –≤–µ—Ä—Ö–Ω–µ—É—Ä–æ–≤–Ω–µ–≤—ã–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Å—Ç–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞</p><p><em>–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü</em></p></li><li><p>–ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–∂–Ω–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏–ª—å–Ω–æ–π –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏</p><p><em>–í –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∏ –∫ –≠–ü</em></p></li></ol></div><p>–í –æ–±—â–µ–º –ø–∏—à–∏—Ç–µ –º–µ–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –≥–æ–¥–∞, –ø—Ä–æ–¥–æ–ª–∂–∞—è —Ä–∞–∑–¥–µ–ª—è—Ç—å –≤–≤–æ–¥-–≤–≤—ã–≤–æ–¥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª–∏–∑—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö (–∏ —Ç–æ–ª—å–∫–æ –µ—ë) –≤ –≤–∏–¥–µ —á–∏—Å—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π - –∏ –±—É–¥–µ—Ç –≤–∞–º –ø—Ä–æ—Å—Ç–æ–µ –¥–µ–≤–µ–ª–æ–ø–µ—Ä—Å–∫–æ–µ —Å—á–∞—Å—Ç—å–µ:)</p><figure class=table-block><figcaption>Table 1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ ROP-–∞ –Ω–∞ –º–æ–Ω–∞–¥–∞—Ö –∏ –ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–æ–≥–æ ROP-–∞</figcaption><table class="frame-all grid-all stretch"><col style=width:50%><col style=width:50%><tbody><tr><td class="halign-left valign-top"><p><a href=https://git.codemonsters.team/guides/ddd-code-toolkit/src/branch/dev/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdateService.kt#L22>–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a></p><div class=listing-block><pre class="rouge highlight"><code data-lang=kotlin><span class=k>fun</span> <span class=nf>dataUpdateProcess</span><span class=p>(</span>
        <span class=n>dataUpdateRequest</span><span class=p>:</span> <span class=nc>SubscriberDataUpdateRequest</span>
<span class=p>):</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberDataUpdateResponse</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
   <span class=nf>getDataUpdate</span><span class=p>(</span><span class=n>dataUpdateRequest</span><span class=p>)</span>
     <span class=p>.</span><span class=nf>flatMap</span> <span class=p>{</span> <span class=nf>getSubscriber</span><span class=p>(</span><span class=n>it</span><span class=p>)</span> <span class=p>}</span>
     <span class=p>.</span><span class=nf>flatMap</span> <span class=p>{</span> <span class=nf>prepareSubscriberUpdateRequest</span><span class=p>(</span><span class=n>it</span><span class=p>)</span> <span class=p>}</span>
     <span class=p>.</span><span class=nf>flatMap</span> <span class=p>{</span> <span class=nf>updateSubscriber</span><span class=p>(</span><span class=n>it</span><span class=p>)</span> <span class=p>}</span>

 <span class=k>private</span> <span class=k>fun</span> <span class=nf>getDataUpdate</span><span class=p>(</span>
     <span class=n>dataUpdateRequest</span><span class=p>:</span> <span class=nc>SubscriberDataUpdateRequest</span>
<span class=p>):</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>DataUpdate</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
     <span class=n>_subscribersClient</span><span class=p>.</span><span class=nf>findDataUpdate</span><span class=p>(</span><span class=n>dataUpdateRequest</span><span class=p>.</span><span class=n>dataUpdateId</span><span class=p>)</span>


<span class=k>private</span> <span class=k>fun</span> <span class=nf>getSubscriber</span><span class=p>(</span>
    <span class=n>dataUpdate</span><span class=p>:</span> <span class=nc>Result</span><span class=p>&lt;</span><span class=nc>DataUpdate</span><span class=p>&gt;</span>
<span class=p>):</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberDataUpdate</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
    <span class=nc>Mono</span><span class=p>.</span><span class=nf>just</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>)</span>
        <span class=p>.</span><span class=nf>filter</span> <span class=p>{</span> <span class=n>it</span><span class=p>.</span><span class=n>isSuccess</span> <span class=p>}</span>
        <span class=p>.</span><span class=nf>flatMap</span> <span class=p>{</span> <span class=nf>getSubscriber</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=nf>getOrThrow</span><span class=p>())</span> <span class=p>}</span>
        <span class=p>.</span><span class=nf>switchIfEmpty</span><span class=p>(</span><span class=nf>incomingFailInDataUpdate</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>))</span>

<span class=k>private</span> <span class=k>fun</span> <span class=nf>getSubscriber</span><span class=p>(</span>
    <span class=n>dataUpdate</span><span class=p>:</span> <span class=nc>DataUpdate</span>
<span class=p>):</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberDataUpdate</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
    <span class=n>_subscribersClient</span><span class=p>.</span><span class=nf>findSubscriber</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>.</span><span class=n>subscriberId</span><span class=p>)</span>
        <span class=p>.</span><span class=nf>map</span> <span class=p>{</span>
            <span class=nc>SubscriberDataUpdate</span><span class=p>.</span><span class=nf>emerge</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>,</span> <span class=n>it</span><span class=p>)</span>
        <span class=p>}</span>

<span class=k>private</span> <span class=k>fun</span> <span class=nf>prepareSubscriberUpdateRequest</span><span class=p>(</span>
           <span class=n>subscriberDataUpdate</span><span class=p>:</span> <span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberDataUpdate</span><span class=p>&gt;</span>
<span class=p>)</span> <span class=p>:</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberUpdateRequest</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
  <span class=nc>Mono</span><span class=p>.</span><span class=nf>just</span><span class=p>(</span><span class=n>subscriberDataUpdate</span><span class=p>)</span>
    <span class=p>.</span><span class=nf>filter</span> <span class=p>{</span> <span class=n>it</span><span class=p>.</span><span class=n>isSuccess</span> <span class=p>}</span>
    <span class=p>.</span><span class=nf>flatMap</span> <span class=p>{</span> <span class=nf>prepareRequest</span><span class=p>(</span><span class=n>it</span><span class=p>.</span><span class=nf>getOrThrow</span><span class=p>())</span> <span class=p>}</span>
                <span class=c1>//^ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–±–æ–Ω–µ–Ω—Ç–∞</span>
    <span class=p>.</span><span class=nf>switchIfEmpty</span><span class=p>(</span>
        <span class=nf>incomingFailInSubscriberDataUpdate</span><span class=p>(</span>
            <span class=n>subscriberDataUpdate</span><span class=p>))</span>

<span class=k>private</span> <span class=k>fun</span> <span class=nf>prepareRequest</span><span class=p>(</span>
         <span class=n>subscriberDataUpdate</span><span class=p>:</span> <span class=nc>SubscriberDataUpdate</span>
<span class=p>):</span> <span class=nc>Mono</span><span class=p>&lt;</span><span class=nc>Result</span><span class=p>&lt;</span><span class=nc>SubscriberUpdateRequest</span><span class=p>&gt;&gt;</span> <span class=p>=</span>
    <span class=nc>Mono</span><span class=p>.</span><span class=nf>just</span><span class=p>(</span><span class=n>subscriberDataUpdate</span><span class=p>.</span><span class=nf>prepareUpdateRequest</span><span class=p>())</span>
              <span class=c1>//^ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –î–æ–º–µ–Ω–Ω–æ–º</span></code></pre></div></td><td class="halign-left valign-top"><div class=listing-block><pre class="rouge highlight"><code data-lang=kotlin><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>dataUpdateProcess</span><span class=p>(</span>
    <span class=n>dataUpdateRequest</span><span class=p>:</span> <span class=nc>SubscriberDataUpdateRequest</span>
<span class=p>):</span> <span class=nc>SubscriberDataUpdateResponse</span> <span class=p>{</span>
   <span class=kd>val</span> <span class=py>dataUpdate</span> <span class=p>=</span> <span class=nf>getDataUpdate</span><span class=p>(</span><span class=n>dataUpdateRequest</span><span class=p>)</span>
   <span class=kd>val</span> <span class=py>subscriber</span> <span class=p>=</span> <span class=nf>getSubscriber</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>)</span>
   <span class=k>if</span> <span class=p>(!</span><span class=n>subscriber</span><span class=p>.</span><span class=nf>isUpdateRequired</span><span class=p>())</span> <span class=p>{</span>
       <span class=k>throw</span> <span class=nc>RuntimeException</span><span class=p>(</span><span class=s>&#34;No Update Required&#34;</span><span class=p>)</span> <span class=c1>// (1)</span>
   <span class=p>}</span>
   <span class=kd>val</span> <span class=py>updateRequest</span> <span class=p>=</span> <span class=n>subscriber</span>
       <span class=p>.</span><span class=nf>prepareSubscriberUpdateRequest</span><span class=p>()</span>
   <span class=kd>val</span> <span class=py>subscriberUpdateResult</span> <span class=p>=</span> <span class=nf>updateSubscriber</span><span class=p>(</span><span class=n>it</span><span class=p>)</span>
   <span class=k>return</span> <span class=n>subscriberUpdateResult</span>
<span class=p>}</span>

<span class=k>private</span> <span class=k>fun</span> <span class=nf>getDataUpdate</span><span class=p>(</span>
    <span class=n>dataUpdateRequest</span><span class=p>:</span> <span class=nc>SubscriberDataUpdateRequest</span>
<span class=p>):</span> <span class=nc>DataUpdate</span> <span class=p>=</span>
    <span class=n>_subscribersClient</span><span class=p>.</span><span class=nf>findDataUpdate</span><span class=p>(</span><span class=n>dataUpdateRequest</span><span class=p>.</span><span class=n>dataUpdateId</span><span class=p>)</span>

<span class=k>suspend</span> <span class=k>fun</span> <span class=nf>getSubscriber</span><span class=p>(</span>
    <span class=n>dataUpdate</span><span class=p>:</span> <span class=nc>DataUpdate</span>
<span class=p>):</span> <span class=nc>SubscriberDataUpdateRequest</span> <span class=p>{</span>
    <span class=kd>val</span> <span class=py>dataUpdateDto</span> <span class=p>=</span>
        <span class=n>_subscribersClient</span>
            <span class=p>.</span><span class=nf>findDataUpdate</span><span class=p>(</span><span class=n>dataUpdateRequest</span><span class=p>.</span><span class=n>dataUpdateId</span><span class=p>)</span>

    <span class=k>return</span> <span class=nc>SubscriberDataUpdate</span><span class=p>.</span><span class=nf>emerge</span><span class=p>(</span><span class=n>dataUpdate</span><span class=p>,</span> <span class=n>dataUpdateDto</span><span class=p>)</span>
<span class=p>}</span></code></pre></div></td></tr></tbody></table></figure><p>(1) –≤–∑—è–ª –∏–∑ <a href=https://git.codemonsters.team/guides/ddd-code-toolkit/src/commit/76cc94ced11f969d934afbfecf30ed7ddcafc5e6/src/main/kotlin/team/codemonsters/ddd/toolkit/domain/subscriberDataUpdate/SubscriberDataUpdate.kt#L22>–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞</a>.</p><p>–ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –≤ —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ —á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –ª–æ–≥–∏–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∞—è:</p><div class="olist arabic"><ol class=arabic><li>–∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–±–æ–Ω–µ–Ω—Ç–∞</li><li>–∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∞–±–æ–Ω–µ–Ω—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º–µ</li><li>—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–±–æ–Ω–µ–Ω—Ç–∞</li><li>–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∞–±–æ–Ω–µ–Ω—Ç–∞</li></ol></div><p>–ò –±–æ–ª–µ–µ —Ç–æ–≥–æ, –≤ —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –µ—â—ë –∏ —Å—Ä–∞–∑—É –ø–æ–¥—Å–≤–µ—á–µ–Ω –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ö–æ–¥ —Å—Ü–µ–Ω–∞—Ä–∏—è "–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è".</p><p>–ê –≤–æ—Ç —Å–≤–µ–∂–∏–π –ø—Ä–∏–º–µ—Ä —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞ c "–ø—Ä–æ–ª–µ—Ç–∞—Ä—Å–∫–∏–º ROP-–æ–º" —É–∂–µ –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ –≠:</p><div class=listing-block><pre class="rouge highlight"><code data-lang=kotlin><span class=kd>class</span> <span class=nc>AnalysisService</span><span class=p>(</span>
    <span class=k>private</span> <span class=kd>val</span> <span class=py>diaryService</span><span class=p>:</span> <span class=nc>DiaryService</span><span class=p>,</span>
    <span class=k>private</span> <span class=kd>val</span> <span class=py>analysisReportCalculator</span><span class=p>:</span> <span class=nc>AnalysisReportCalculator</span><span class=p>,</span>
<span class=p>)</span> <span class=p>{</span>

    <span class=k>fun</span> <span class=nf>getAnalysisReport</span><span class=p>(</span><span class=n>userId</span><span class=p>:</span> <span class=nc>Int</span><span class=p>,</span> <span class=n>start</span><span class=p>:</span> <span class=nc>Instant</span><span class=p>,</span> <span class=n>end</span><span class=p>:</span> <span class=nc>Instant</span><span class=p>):</span> <span class=nc>AnalysisReport</span> <span class=p>{</span>
        <span class=kd>val</span> <span class=py>reportEvents</span> <span class=p>=</span> <span class=n>diaryService</span><span class=p>.</span><span class=nf>getReportEvents</span><span class=p>(</span><span class=n>userId</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>)</span>
        <span class=kd>val</span> <span class=py>analysisReport</span> <span class=p>=</span> <span class=n>analysisReportCalculator</span><span class=p>.</span><span class=nf>calculateAnalysisReport</span><span class=p>(</span><span class=n>reportEvents</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>analysisReport</span>
    <span class=p>}</span>

<span class=p>}</span></code></pre></div><p>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è <code>calculateAnalysisReport</code> –Ω–∞ 300 —Å—Ç—Ä–æ–∫ –≤ –≤–∏–¥–µ —á–∏—Å—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:</p><div class=image-block><img src=/microposts/22/11/images/ea-at-jpoint-db379.png alt="ea at jpoint db379"></div><p>–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ —ç—Ç–æ—Ç –∫–æ–¥ –ø–∏—Å–∞–ª –Ω–µ —è, –Ω–æ —è –µ–≥–æ —Ä–µ–≤—å—é–≤–∏–ª –∏ –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –Ω—ë–º —à—Ç–∞–º–ø "–°–æ–æ—Ç–≤–µ—Ç—Å–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –≠–ü".
–ò–º–µ–Ω–Ω–æ —Ç–∞–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π —ç—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –∫–æ–¥ - —Ç—Ä–∏ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å—Ç—Ä–æ—á–∫–∏ –≤ —Å–µ—Ä–≤–∏—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏ –∫—É—á–∞ —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞ –≤ –¥–æ–º–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.</p></article></section></div></main><script src=/js/app.js></script></body></html>